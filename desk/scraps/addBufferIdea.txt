we encounter leaves in the correct order, just split tkns into types and buffers, add buffers as leaves are encountered
