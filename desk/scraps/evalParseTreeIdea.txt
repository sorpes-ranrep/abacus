make separate arm/gate for each rule
call them on nodes to enforce types and compile
